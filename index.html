<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Enquiry Log</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>Enquiry Log (Test)</h2>

<select id="month"></select>
<button onclick="add()">Add Enquiry</button>
<button onclick="download()">Download Excel</button>

<table border="1" id="table">
  <tr>
    <th>Sl.No</th>
    <th>Project</th>
  </tr>
</table>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
const KEY = "enquiry_test";
let data = JSON.parse(localStorage.getItem(KEY)) || {};
let current = "2025-01";

const monthSel = document.getElementById("month");
const table = document.getElementById("table");

function initMonths(){
  let d = new Date(2025,0,1);
  const end = new Date(2026,0,1);
  while(d<=end){
    const v = d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0");
    monthSel.add(new Option(v,v));
    d.setMonth(d.getMonth()+1);
  }
  monthSel.value = current;
  load();
}

monthSel.onchange = ()=>{ current = monthSel.value; load(); };

function load(){
  table.innerHTML = `
    <tr><th>Sl.No</th><th>Project</th></tr>
  `;
  (data[current]||[]).forEach((r,i)=>{
    table.innerHTML += `<tr><td>${i+1}</td><td>${r}</td></tr>`;
  });
}

function add(){
  data[current] = data[current] || [];
  data[current].push("Test Project");
  localStorage.setItem(KEY, JSON.stringify(data));
  load();
}

function download(){
  const rows = (data[current]||[]).map((p,i)=>({SlNo:i+1,Project:p}));
  const ws = XLSX.utils.json_to_sheet(rows);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, current);
  XLSX.writeFile(wb, `Test_${current}.xlsx`);
}

initMonths();
</script>

</body>
</html>
